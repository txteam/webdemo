/*
 *
 * Wijmo Library 2.3.0
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the Wijmo Commercial License. Also available under the GNU GPL Version 3 license.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 *
 **/
var __extends=this.__extends||function(b,c){function a(){this.constructor=b}a.prototype=c.prototype;b.prototype=new a},wijmo;(function(b){"use strict";var a=jQuery,d=function(d){__extends(b,d);function b(){d.apply(this,arguments)}b.prototype._create=function(){var b=this,c;if(this.element[0].tagName.toLowerCase()!=="input")throw"Target element is not a INPUT";if(window.wijmoApplyWijTouchUtilEvents)a=window.wijmoApplyWijTouchUtilEvents(a);this.element.is(":hidden")&&this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){b._destroy();b._create();b.element.wijRemoveVisibilityObserver&&b.element.wijRemoveVisibilityObserver()},"wijinput");this.element.data("widgetName",this.widgetName);a.effects.save(this.element,["width","height"]);this.element.wrap("<div class='wijmo-wijinput ui-widget ui-helper-clearfix ui-state-default ui-corner-all'><span class='wijmo-wijinput-wrapper'></span></div>");this.element.addClass("wijmo-wijinput-input ui-corner-all").attr("role","textbox");if(!(a.browser.msie&&parseFloat(a.browser.version)<=7))try{this.element.attr("aria-multiline",false)}catch(d){this.element[0].setAttribute("aria-multiline","false")}this.wrapper=this.element.parent();this.outerDiv=this.wrapper.parent();if(this.options.showTrigger){this.triggerBtn=a("<div class='wijmo-wijinput-trigger ui-state-default'><span class='ui-icon ui-icon-triangle-1-s'></span></div>").addClass(this.options.buttonAlign==="left"?"ui-corner-left":"ui-corner-right").attr("role","button").appendTo(this.outerDiv);this.element.attr({role:"combobox","aria-expanded":false})}if(this.options.showSpinner){this.spinner=a("<div class='wijmo-wijinput-spinner wijmo-wijinput-button'></div>");this.spinUp=a("<div class='ui-state-default wijmo-wijinput-spinup'><span class='ui-icon ui-icon-triangle-1-n'></span></div>").attr("role","button");this.spinDown=a("<div class='ui-state-default wijmo-wijinput-spindown'><span class='ui-icon ui-icon-triangle-1-s'></span></div>").attr("role","button");if(!this.options.showTrigger){this.spinUp.addClass(this.options.buttonAlign==="left"?"ui-corner-tl":"ui-corner-tr");this.spinDown.addClass(this.options.buttonAlign==="left"?"ui-corner-bl":"ui-corner-br")}this.spinner.append(this.spinUp).append(this.spinDown).appendTo(this.outerDiv);this.element.attr("role","spinner")}if(this.options.showTrigger&&this.options.showSpinner)this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-spinner-trigger-left":"ui-input-spinner-trigger-right");else{this.options.showTrigger&&this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-trigger-left":"ui-input-trigger-right");this.options.showSpinner&&this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-spinner-left":"ui-input-spinner-right")}this._initialize();this.outerDiv.width(this.element.width());c=this.element.leftBorderWidth()+this.element.rightBorderWidth();this.element.width(this.outerDiv.width()-c)};b.prototype._createTextProvider=function(){return undefined};b.prototype._beginUpdate=function(){};b.prototype._endUpdate=function(){};b.prototype._onTriggerClicked=function(){};b.prototype._initialize=function(){var b=this;this.element.data("initializing",true);this._trigger("initializing");this.element.data("preText",this.element.val());this.element.data("elementValue",this.element.val());this.element.data("errorstate",false);this.element.data("breakSpinner",true);this.element.data("prevCursorPos",-1);this.element.data("simulating",false);this._createTextProvider();this._beginUpdate();var c=this.options,d=function(a){return(!a.which?a.button:a.which)===1},e=function(c){if(b.options.disabled)return;if(!d(c))return;b._trySetFocus();b.element.data("breakSpinner",false);b._addState("active",a(b));b._doSpin(a(c.currentTarget).hasClass("wijmo-wijinput-spinup"),true)},f=function(c){if(b.options.disabled)return;if(!d(c))return;b._stopSpin();b._removeState("active",a(b))},g;this.triggerBtn&&!c.disabledState&&this.triggerBtn.bind({mouseover:function(){if(b.options.disabled)return;b._addState("hover",a(b))},mouseout:function(){if(b.options.disabled)return;b._removeState("hover",a(b))},mousedown:function(c){if(b.options.disabled)return;if(!d(c))return;b._addState("active",a(b));b._trigger("triggerMouseDown")},click:function(c){if(b.options.disabled)return;b._stopEvent(c);b._stopSpin();b._removeState("active",a(b));b._trigger("triggerMouseUp");b._onTriggerClicked();b._trySetFocus()}});this.spinUp&&!c.disabledState&&this.spinUp.bind({mouseover:function(){if(b.options.disabled)return;b._addState("hover",a(b))},mouseout:function(){if(b.options.disabled)return;b._removeState("hover",a(b));b._removeState("active",a(b));b._stopSpin()},mousedown:e,mouseup:f});this.spinDown&&!c.disabledState&&this.spinDown.bind({mouseover:function(){if(b.options.disabled)return;b._addState("hover",a(b))},mouseout:function(){if(b.options.disabled)return;b._removeState("hover",a(b));b._removeState("active",a(b));b._stopSpin()},mousedown:e,mouseup:f});this.element.bind({"focus.wijinput":a.proxy(this._onFocus,this),"blur.wijinput":a.proxy(this._onBlur,this),"mouseup.wijinput":a.proxy(this._onMouseUp,this),"keypress.wijinput":a.proxy(this._onKeyPress,this),"keydown.wijinput":a.proxy(this._onKeyDown,this),"keyup.wijinput":a.proxy(this._onKeyUp,this),"compositionstart.wijinput":a.proxy(this._onCompositionStart,this),"compositionend.wijinput":a.proxy(this._onCompositionEnd,this),"change.wijinput":a.proxy(this._onChange,this),"paste.wijinput":a.proxy(this._onPaste,this),"drop.wijinput":a.proxy(this._onDrop,this)});this.element.bind("propertychange.wijinput input.wijinput",a.proxy(this._onInput,this));this.element.data("initializing",false);this._resetData();this._endUpdate();this._updateText();if(this.options.disabledState){g=c.disabled;this.disable();c.disabled=g}this.options.disabled&&this.disable();this.element.data("initialized",true);this._trigger("initialized")};b.prototype._init=function(){};b.prototype._setOption=function(d,c){this._super(d,c);switch(d){case"buttonAlign":case"showTrigger":case"showSpinner":this._destroy();this._create();break;case"showNullText":this._updateText();break;case"disabled":this.element.attr("disabled",c);var b=c?"addClass":"removeClass",a=this.namespace+"-state-disabled";this.element[b](a);this.triggerBtn&&this.triggerBtn[b](a);this.spinUp&&this.spinUp[b](a);this.spinDown&&this.spinDown[b](a)}};b.prototype.destroy=function(){this._super();this._destroy()};b.prototype.isDestroyed=function(){return!this.outerDiv};b.prototype._destroy=function(){if(this.isDestroyed())return;this.wrapper=undefined;this.outerDiv=undefined;this.element.unbind(".wijinput");this.element.removeData("errorstate").removeData("breakSpinner").removeData("prevCursorPos").removeData("simulating").removeData("isPassword").removeClass("wijmo-wijinput-input").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow").removeAttr("aria-expanded");this.element.parent().replaceWith(this.element);this.element.parent().replaceWith(this.element);a.effects.restore(this.element,["width","height"])};b.prototype.widget=function(){return this.outerDiv||this._super()};b.prototype._getCulture=function(a){if(typeof a==="undefined")a=this.options.culture;return Globalize.findClosestCulture(a||this.options.culture)};b.prototype._addState=function(b,a){a.is(":not(.ui-state-disabled)")&&a.addClass("ui-state-"+b)};b.prototype._removeState=function(a,b){b.removeClass("ui-state-"+a)};b.prototype._isInitialized=function(){return!this.element.data("initializing")};b.prototype._setData=function(a){this.setText(a)};b.prototype._resetData=function(){};b.prototype._validateData=function(){};b.prototype.getText=function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,false,false)};b.prototype.setText=function(a){if(!this._isInitialized())this.element.val(a);else{this._textProvider.set(a);this._updateText()}};b.prototype.getPostValue=function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,false,true)};b.prototype.selectText=function(a,b){if(this.element.is(":disabled"))return;this.element.wijtextselection(a,b)};b.prototype.focus=function(){if(this.element.is(":disabled"))return;this.element.get(0).focus()};b.prototype.isFocused=function(){return this.outerDiv.hasClass("ui-state-focus")};b.prototype._raiseTextChanged=function(){var a=this.element.val(),b=this.element.data("preText");if(!!this.element.data("initialized")&&b!==a){this._trigger("textChanged",null,{text:a});this.element.data("changed",true)}this.element.data("preText",a)};b.prototype._raiseDataChanged=function(){};b.prototype._allowEdit=function(){return!(this.element.attr("readOnly")&&this.element.is(":disabled"))};b.prototype._updateText=function(a){if(typeof a==="undefined")a=false;if(!this._isInitialized())return;a=!!a;var b=this.element.wijtextselection(),c=this.options;if(this.isDeleteAll&&c.showNullText){this.isDeleteAll=false;c.date=null;this.element.val(c.nullText)}else{this.element.val(this._textProvider.toString());this.options.text=this._textProvider.toString(true,false,false)}if(this.element.is(":disabled"))return;a&&this.selectText(b.start,b.end);this.element.data("prevCursorPos",b.start);this._raiseTextChanged();this._raiseDataChanged()};b.prototype._trySetFocus=function(){if(!this.isFocused())try{!this.options.disableUserInput&&this.element.focus()}catch(a){}};b.prototype._deleteSelText=function(d){if(typeof d==="undefined")d=false;if(!this._allowEdit())return;var a=this.element.wijtextselection(),b;if(d){if(a.end<1)return;if(a.end===a.start)a.start--}a.end--;if(a.end<a.start)a.end=a.start;b=new c;this._textProvider.removeAt(a.start,a.end,b);this._updateText();this.selectText(b.testPosition,b.testPosition)};b.prototype._fireIvalidInputEvent=function(d){var b=this,c;if(a.isFunction(b.options.invalidInput)&&b._trigger("invalidInput",null,{widget:b,"char":d})===true)return;if(!b.element.data("errorstate")){c=b.options.invalidClass||"ui-state-error";b.element.data("errorstate",true);window.setTimeout(function(){b.outerDiv.removeClass(c);b.element.data("errorstate",false)},200);b.outerDiv.addClass(c)}};b.prototype._onInput=function(){if(!this._isSimulating()||!this.element.data("ime")||this.element.data("isComposingIME")){this.element.data("isComposingIME")&&this.element.data("simulationPending",true);return}this._simulate()};b.prototype._keyDownPreview=function(){return false};b.prototype._onDoubleByteCharacter=function(){var a=this.element.data("lastDbsState"),c=this.element.wijtextselection(),b=this.element.val();if(this.element.data("isComposingIME")&&a&&a.selection.start===c.start&&a.Text===b){this.element.removeData("lastDbsState");this._onCompositionEnd()}else{this.element.data("lastDbsState",{selection:c,text:b});this._onCompositionStart()}};b.prototype._onCompositionStart=function(){if(this.element.data("isComposingIME"))return;this.element.data("isComposingIME",true);this._beforeSimulate(true)};b.prototype._onCompositionEnd=function(){if(!this.element.data("isComposingIME"))return;this.element.data("isComposingIME",false);this._isInitialized()&&(!this._textProvider||!this._textProvider.noMask)&&this._simulateIfPending()};b.prototype._simulateIfPending=function(){this.element.data("simulationPending")&&this.element.data("lastSelection")&&this._simulate()};b.prototype._beforeSimulate=function(a){if(typeof a==="undefined")a=false;if(!this.element.data("lastSelection")){this.element.data("lastSelection",this.element.wijtextselection());this.element.data("lastValue",this.element.val())}this.element.data("ime",a);this.element.data("simulating",true)};b.prototype._isSimulating=function(){return this.element.data("simulating")};b.prototype._simulate=function(f){var a=this,b=null,e,c,d;this.element.data("simulationPending",false);if(typeof f==="string")b=f;else{e=this.element.wijtextselection();c=this.element.data("lastSelection").start;d=e.end;if(d>=c)b=this.element.val().substring(c,d)}b&&window.setTimeout(function(){if(!a.element.data("lastValue"))return;a.element.val(a.element.data("lastValue"));var e=a.element.data("lastSelection"),c,d;a.element.wijtextselection(e);a.element.data("batchKeyPress",true);a.element.data("simulating",false);c=jQuery.Event("keypress");c.ctrlKey=c.altKey=false;for(d=0;d<b.length;d++){c.which=c.charCode=c.keyCode=b.charCodeAt(d);a._onKeyPress(c)}a.element.data("batchKeyPress",false);a._endSimulate()},1)};b.prototype._endSimulate=function(){this._simulateIfPending();this.element.removeData("ime");this.element.removeData("lastSelection");this.element.removeData("lastValue")};b.prototype._onKeyDown=function(b){this.element.data("prevCursorPos",-1);if(!this._isInitialized()||this._textProvider&&!!this._textProvider.noMask)return;var c=this._getKeyCode(b);if(c===229){this._onDoubleByteCharacter();return}this._onCompositionEnd();if(this.options.disableUserInput){this._stopEvent(b);return}if(this._keyDownPreview(b)){this._stopEvent(b);return}switch(c){case a.ui.keyCode.UP:this._doSpin(true,false);this._stopEvent(b);return;case a.ui.keyCode.DOWN:this._doSpin(false,false);this._stopEvent(b);return}if(b.ctrlKey)switch(c){case a.ui.keyCode.INSERT:case 67:return}if(b.ctrlKey||b.altKey)return;switch(c){case 112:case 113:case 114:case 115:case 116:case 117:case a.ui.keyCode.TAB:case a.ui.keyCode.CAPSLOCK:case a.ui.keyCode.END:case a.ui.keyCode.HOME:case a.ui.keyCode.CTRL:case a.ui.keyCode.SHIFT:return;case a.ui.keyCode.BACKSPACE:this._deleteSelText(true);this._stopEvent(b);return;case a.ui.keyCode.DELETE:this._deleteSelText(false);this._stopEvent(b);return;case a.ui.keyCode.ENTER:if(!this.options.hideEnter)return;break;case a.ui.keyCode.ESCAPE:this._stopEvent(b);window.setTimeout(a.proxy(this._resetData,this),1);return;case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.ALT:this._stopEvent(b);return}};b.prototype._onKeyUp=function(c){if(this._textProvider&&!!this._textProvider.noMask)return;var b=this._getKeyCode(c);if(this._isSimulating()){b===a.ui.keyCode.ENTER&&this._onCompositionEnd();return}if(!this._isInitialized())return;if(b===a.ui.keyCode.ENTER||b===a.ui.keyCode.ESCAPE)return;if(this.options.disableUserInput){this._raiseTextChanged();this._raiseDataChanged();return}this._stopEvent(c)};b.prototype._getKeyCode=function(a){var b=window.navigator.userAgent;return(b.indexOf("iPod")!==-1||b.indexOf("iPhone")!==-1)&&a.which===127?8:a.keyCode||a.which};b.prototype._keyPressPreview=function(){return false};b.prototype._onKeyPress=function(b){if(this._isSimulating()||this._textProvider&&!!this._textProvider.noMask)return;this.element.data("prevCursorPos",-1);if(this.options.disableUserInput)return;if(!this._allowEdit())return;if(b.ctrlKey&&b.keyCode===119){this._onPaste(b);return}var c=b.keyCode||b.which,d,e;if(c===0)return;if(c===a.ui.keyCode.BACKSPACE){this._stopEvent(b);return}if(b.ctrlKey||b.altKey)if(c!==a.ui.keyCode.SPACE)return;if(this._keyPressPreview(b))return;if(c===a.ui.keyCode.ENTER&&!this.options.hideEnter)return true;e=String.fromCharCode(c);d=this._textProvider.replaceWith(this.element.wijtextselection(),e);if(d){this._updateText();this.selectText(d.testPosition+1,d.testPosition+1)}else this._fireIvalidInputEvent(e);!this.element.data("batchKeyPress")&&this._stopEvent(b)};b.prototype._isNullText=function(a){a=a||this.element.val();return this.options.showNullText&&a===this.options.nullText};b.prototype._doFocus=function(){var d=this.element.wijtextselection(),b=d.start,c;this._updateText();c=this.element.val();if(c.length===b)b=0;!a.browser.safari&&this.selectText(b,b)};b.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()};b.prototype._onFocus=function(){if(this.options.disableUserInput)return;this._addState("focus",this.outerDiv);if(!this.element.data("breakSpinner"))return;if(!this._isInitialized())return;if(!this._allowEdit())return;!this.element.data("focusNotCalledFirstTime")&&this.element.data("focusNotCalledFirstTime",+new Date);this._afterFocused()};b.prototype._onBlur=function(){if(this.options.disableUserInput)return;this._onCompositionEnd();if(this._isComboListVisible())return;var c=this.isFocused(),b,a=this;this._removeState("focus",this.outerDiv);if(!this.element.data("breakSpinner")){this.element.get(0).focus();b=this.element.data("prevCursorPos");b!==undefined&&b!==-1&&this.selectText(b,b);return}if(!this._isInitialized())return;if(!c)return;this.element.data("value",this.element.val());window.setTimeout(function(){a._onChange();a._updateText();a._validateData();!a._popupVisible()&&!!a.element.data("changed")&&a._trigger("change");a.element.data("changed",false)},100)};b.prototype._popupVisible=function(){return this._isComboListVisible()};b.prototype._onMouseUp=function(){if(!this._isInitialized())return;if(this.element.is(":disabled"))return;var a=this.element.wijtextselection();this.element.data("prevCursorPos",a.start)};b.prototype._onChange=function(){if(!this.element)return;var a=this.element.val(),b=this.getText();b!==a&&this.setText(a)};b.prototype._onPaste=function(){if(this._textProvider&&!!this._textProvider.noMask)return;this._beforeSimulate();var a=this;window.setTimeout(function(){a._simulate()},1)};b.prototype._onDrop=function(a){this._beforeSimulate();if(a.originalEvent&&a.originalEvent.dataTransfer){var b=a.originalEvent.dataTransfer.getData("Text");b&&this._simulate(b)}};b.prototype._stopEvent=function(a){a.stopPropagation();a.preventDefault()};b.prototype._calcSpinInterval=function(){this._repeatingCount++;return this._repeatingCount>10?50:this._repeatingCount>4?100:this._repeatingCount>2?200:400};b.prototype._doSpin=function(){};b.prototype._stopSpin=function(){this.element.data("breakSpinner",true);this._repeatingCount=0};b.prototype._hasComboItems=function(){return!!this.options.comboItems&&this.options.comboItems.length};b.prototype._isComboListVisible=function(){return!this._comboDiv?false:this._comboDiv.wijpopup("isVisible")};b.prototype._popupComboList=function(){if(!this._hasComboItems())return;if(!this._allowEdit())return;if(this._isComboListVisible()){this._comboDiv.wijpopup("hide");return}var b=this,c;if(this._comboDiv===undefined){this._comboDiv=a("<div></div>").appendTo(document.body).width(this.outerDiv.width()).height(this.options.comboHeight||180).css("position","absolute");c=this._normalize(this.options.comboItems);this._comboDiv.wijlist({autoSize:true,maxItemsCount:5,selected:function(c,a){b._setData(a.item.value);b._comboDiv.wijpopup("hide");b._trySetFocus()}});this._comboDiv.wijlist("setItems",c);this._comboDiv.wijlist("renderList");this._comboDiv.wijlist("refreshSuperPanel")}this._comboDiv.wijpopup({autoHide:true});this.outerDiv.attr("aria-expanded",true);this._comboDiv.wijpopup("show",{of:this.outerDiv,offset:"0 4",hidden:function(){b.outerDiv.attr("aria-expanded",false)}})};b.prototype._normalize=function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b==="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})};return b}(b.WijmoWidget);b.wijinputcore=d;d.prototype.options=a.extend({},b.WijmoWidget.prototype.options,{culture:"",invalidClass:"ui-state-error",nullText:"",showNullText:false,hideEnter:false,disableUserInput:false,buttonAlign:"right",showTrigger:false,showSpinner:false,comboItems:undefined,comboWidth:undefined,comboHeight:undefined,initializing:null,initialized:null,triggerMouseDown:null,triggerMouseUp:null,textChanged:null,invalidInput:null});var c=function(){function a(){this.characterEscaped=1;this.noEffect=2;this.sideEffect=3;this.success=4;this.unknown=0;this.hint=0;this.alphanumericCharacterExpected=-2;this.asciiCharacterExpected=-1;this.digitExpected=-3;this.invalidInput=-51;this.letterExpected=-4;this.nonEditPosition=-54;this.positionOutOfRange=-55;this.promptCharNotAllowed=-52;this.signedDigitExpected=-5;this.unavailableEditPosition=-53;this.testPosition=-1}a.prototype.clone=function(){var b=new a;b.hint=this.hint;b.testPosition=this.testPosition;return b};return a}();b.wijInputResult=c;var e=function(){function a(){}a.prototype.set=function(){};a.prototype.toString=function(){return""};a.prototype.insertAt=function(){return false};a.prototype.removeAt=function(){};a.prototype.replaceWith=function(a,e){var d=a.start,b=new c;if(a.start<a.end){this.removeAt(a.start,a.end-1,b,true);d=b.testPosition}return this.insertAt(e,d,b)?b:null};return a}();b.wijTextProvider=e})(wijmo||(wijmo={}));var wijinputcore=wijmo.wijinputcore.prototype,wijInputResult=wijmo.wijInputResult;